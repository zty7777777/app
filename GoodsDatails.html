<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<link rel="stylesheet" type="text/css" href="css/icons-extra.css" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<script type="text/javascript" src="js/mui.min.js"></script>

		<title></title>
		
	</head>
	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">商品详情</h1>
		</header>
		<input type="hidden" name="goods_id" id="goods_id" value="" />
		<div class="mui-content">
			<div class="mui-card" style="width: 98%;">
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						商品名称: <span id="channel" ></span>
					</li>
					<li class="mui-table-view-cell">
						商品数量: <span id="bill_no" >1</span>
					</li>
					<li class="mui-table-view-cell">
						商品金额: <span id="total_fee"></span>
					</li>
					<li class="mui-table-view-cell">
						浏览次数: <span id="look_count"></span>
					</li>
					<li align="right">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

						<button type="button" class="mui-btn mui-btn-warning" id="but">
							加入购物车 <span class="mui-icon-extra mui-icon-extra-cart"></span>
						</button>
					</li>
				</ul>
			</div>
		</div>
	</body>
</html>
<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
<script>
	mui.init();
	$(function(){
		//获取列表页面get请求的商品id
		function GetQueryString(name)
		{
			var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
			var r = window.location.search.substr(1).match(reg);
			if(r!=null)return  unescape(r[2]); return null;
		}
		
		var goods_id = GetQueryString("goods_id");
		//通过post传给api
		$.post(
			"http://second.zty77.com/hb/goodsdetail",
			{goods_id:goods_id},
			function(msg){
				//api返回参数
				if(msg.error==0){
					goods_name=msg.data.goods_name
					goods_price=msg.data.goods_price
					buy_num=1
					goods_id1=msg.data.goods_id
					$("#channel").html("<span>"+msg.data.goods_name+"</span>")
					$("#bill_no").html("1")
					$("#total_fee").html("<span>"+msg.data.goods_price+"</span>")
					$("#goods_id").val(msg.data.goods_id)
					$("#look_count").html("<span>"+msg.look_count+"</span>");
				}
			},
			'json'
		)
<<<<<<< HEAD

<<<<<<< HEAD
		
=======
		//加入购物车按钮 提交 api   5
		$("#but").click(function(){			
>>>>>>> 90877c1a744509108db8515e32ba748dc9109415

		})
		//加入购物车按钮 提交 api   2

		var name = $("#channel").text();
		var num = $("#bill_no").text();
		var price = $("#total_fee").text();
		console.log(name)
=======
>>>>>>> 554a6e5eefab547531ea42ad8463791590bf4ee9
		//加入购物车按钮 提交 api   5
		$("#but").click(function(){
// 			alert(goods_name)
// 			alert(goods_price)
// 			alert(buy_num)
// 			alert(goods_id1)
			$.post(
				"http://second.zty77.com/cartadd",
				{goods_name:goods_name,buy_num:buy_num,goods_price:goods_price,goods_id:goods_id1},
<<<<<<< HEAD
				function(msg){
					 alert(msg.error);
=======
				function(msg){
					// alert(msg.error);
>>>>>>> 554a6e5eefab547531ea42ad8463791590bf4ee9
					if(msg.error==0){
						alert('添加成功')
						window.location.replace('cart.html');
					}else{
						mui.alert(msg.msg,'添加失败','确定',function (e) {
						   e.index
						},'div')
					}
				},
				'json'
			)
		});
	})
</script>
		

